<!DOCTYPE html>
<!--[if IE 8]> 				 <html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="Responsive Single Page HTML5 CSS3 Template">
	<meta name="keywords" content="HTML,CSS,XML,JavaScript,Template,HTML5,CSS3,JS,jQuery,Ajax,portfolio,single-page,one-page,Theme,bootstrap,bootstrap 3,twitter,facebook,instagram">

	<title>Music and Lyrics</title>

	<link href="favicon1.ico" rel="icon" type="image/x-icon" />
	<!-- STYLESHEETS -->
	<link rel="stylesheet" href="css/bootstrap.css" />
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/styles.css" />
	<!-- FONTS -->
	<link href='http://fonts.googleapis.com/css?family=Cabin:400,700,400italic|Merriweather:900' rel='stylesheet' type='text/css'>
	<script src="js/custom.modernizr.js"></script>

</head>
<body>
	
	<!-- START PAGE -->
	<div id="page">	
	
		<!-- START HEADER -->
		<header id="header" class="smooth">
			<div class="row">
				<div class="col-xs-12">
					<div id="intro" class="text-container">
						<div id="logo">
							<img src="images/note_img.svg" alt="logo" />
						</div>
						<h1>Music and Lyrics:</h1>
						<h2>Genre Classification With Audio Features and Lyrics</h2>
						<div id="explore"><a class="scroll" href="#team"><i class="icon-angle-down icon-4x"></i></a></div>
					</div>
				</div>
			</div>
		</header>
		<!-- END HEADER -->

    <!-- START TOP-BAR -->
    <div id="top-bar">
      <div class="container">
        <div class="row">
          <div class="col-md-4">
            <div id="logo-lettering" ><a href="#"><h3>Music and Lyrics</h3><a>
            </div>
            <!-- the hidden classes of the official release are no accumlative. that's why we used the @TurchenkoAlex ones.  
            https://github.com/TurchenkoAlex/bootstrap/tree/3.0.0-wip/dist/css -->
            <div id="menu-mobile" class="hidden-md hidden-lg">
              <i class="icon-reorder icon-2x"></i>
            </div>
          </div>
          <div class="col-md-8">
            <nav id="top-navigation">
              <ul class="list-inline">
                <li><a href="#team">Team</a></li>
                <li><a href="#introduction">Introduction</a></li>
                <li><a href="#approach">Approach</a></li>
                <li><a href="#dataset">Dataset</a></li>
                <li><a href="#results">Results</a></li>
                <li><a href="#paper">Paper</a></li>
              </ul>
            </nav>
          </div>
        </div>
      </div>
    </div>
    <!-- END TOP-BAR -->  
		
		
		<!-- START TEAM SECTION -->
		<section id="team">
			<div class="row">
				<div class="col-xs-12 col-sm-6 col-sm-offset-3 intro">
					<h1>Our Team</h1>
					<p>We're all seniors at Northwestern University, and this is our final project for <a href="http://www.cs.northwestern.edu/~pardo/courses/eecs349/">EECS 349 Machine Learning</a> with Professor Pardo at Northwestern University.</p>
				</div>
			</div>


			<div class="container row">
				<div class="col-xs-6 col-sm-6 col-md-3 member">
					<div class="member-photo">
						<div class="image">
							<img src="images/team/moritz.jpg" alt="Team Member 1">
						</div>
						<div class="image-hover">
							<img src="images/team/moritz.jpg" alt="Team Member 1">
						</div>
						<div class="member-hover hidden-xs hidden-sm">
							<div class="list-container">
								<ul class="list-inline social">
									<li><a href="https://github.com/moritzg91"><i class="icon-github icon-3x"></i></a></li>
									<li><a href="http://www.linkedin.com/in/mjgellner"><i class="icon-linkedin icon-3x"></i></a></li>
								</ul>
							</div>
						</div>
					</div>
					<h5>Moritz Gellner</h5>
                    <h6>moritz.gellner {at} u.northwestern.edu</h6>
					<div class="list-container visible-xs visible-sm">
						<ul class="list-inline">
							<li><a><i class="icon-facebook icon-2x"></i></a></li>
							<li><a><i class="icon-twitter icon-2x"></i></a></li>
							 <li><a><i class="icon-envelope icon-2x"></i></a></li>
						</ul>
					</div>	
				</div>

				<div class="col-xs-6 col-sm-6 col-md-3 member">
					<div class="member-photo">
						<div class="image">
							<img src="images/team/sam.jpg" alt="Team Member 3">
						</div>
						<div class="image-hover">
							<img src="images/team/sam.jpg" alt="Team Member 3">
						</div>
						<div class="member-hover hidden-xs hidden-sm">
							<div class="list-container">
								<ul class="list-inline social">
									<li><a href="https://github.com/sammysf"><i class="icon-github icon-3x"></i></a></li>
									<li><a href="http://www.linkedin.com/profile/view?id=136683900"><i class="icon-linkedin icon-3x"></i></a></li>
								</ul>
							</div>
						</div>
					</div>
					<h5>Sam Toizer</h5>
                    <h6>sam.toizer {at} u.northwestern.edu</h6>
					<div class="list-container visible-xs visible-sm">
						<ul class="list-inline">
							<li><a href="https://github.com/sammysf"><i class="icon-github icon-2x"></i></a></li>
							<li><a href="http://www.linkedin.com/profile/view?id=136683900"><i class="icon-linkedin icon-2x"></i></a></li>

						</ul>
					</div>				
				</div>
				<div class="col-xs-6 col-sm-6 col-md-3 member">
					<div class="member-photo">
						<div class="image">
							<img src="images/team/carson.jpg" alt="Team Member 2">
						</div>
						<div class="image-hover">
							<img src="images/team/carson.jpg" alt="Team Member 2">
						</div>
						<div class="member-hover hidden-xs hidden-sm">
							<div class="list-container">
								<ul class="list-inline social">
									<li><a href="https://github.com/cpottamus"><i class="icon-github icon-3x"></i></a></li>
									<li><a href="http://www.linkedin.com/profile/view?id=141468640"><i class="icon-linkedin icon-3x"></i></a></li>
								</ul>
							</div>
						</div>
					</div>
					<h5>Carson Potter</h5>
                    <h6>cp3192 {at} gmail.com</h6>
					<div class="list-container visible-xs visible-sm">
						<ul class="list-inline">
							<li><a><i class="icon-github icon-3x"></i></a></li>
                            <li><a><i class="icon-linkedin icon-3x"></i></a></li>
						</ul>
					</div>				
				</div>
				<div class="col-xs-6 col-sm-6 col-md-3 member">
					<div class="member-photo">
						<img src="images/team/josh.jpg" alt="Josh Jacobson">
						<div class="member-hover hidden-xs hidden-sm">
							<div class="list-container">
								<ul class="list-inline social">
									<li><a href="https://github.com/josh-jacobson"><i class="icon-github icon-3x"></i></a></li>
									<li><a href="http://www.linkedin.com/profile/view?id=105153016"><i class="icon-linkedin icon-3x"></i></a></li>
								</ul>
							</div>
						</div>
					</div>
					<h5>Josh Jacobson</h5>
          <h6>joshj {at} u.northwestern.edu</h6>
          <div class="list-container visible-xs visible-sm">
						<ul class="list-inline">
							<li><a href="#contacts" class="mail scroll"><i class="icon-envelope icon-2x"></i></a></li>
						</ul>
					</div>	
				</div>		
			</div>
		</section>
		<!-- END TEAM SECTION -->
		
		<!-- START INTRODUCTION SECTION -->
		<section id="introduction">
			<div class="row">
				<div class="col-xs-12 col-sm-6 col-sm-offset-3 intro">
					<h1>Introduction</h1>
          <h4>Our Goal</h4>
					<p>Genre classification is a somewhat popular topic for research, particularly in the field of Music Information Retrieval. There have been many papers published on methods for classifying genres using audio features and other methods. Our goal for this project was to conduct a comparative anlaysis between genre classification using low-level audio features
                    and genre classification using lyrics. If the accuracy of lyric-based classification
                    had proved to be significantly higher than using prior probability, we would have attempted to use boosting
                    to combine these two classification methods to create a more powerful classifier, but our tests showed
                    that a Naïve Bayesian classifier using lyrics fails to outperform prior probability by a statistically significant margin,
                    so our genre classifier ultimately relied solely on analysis of low-level audio features.</p>

                    <h4>Motivation</h4>
                    <p>Our interest in this topic arises primarily from a passion for music. The process of classifying
                    genres with a machine learning method will reveal a lot about the fundamental characteristics of different genres
                    and the underlying mathematical nature of all music.</p>

                    <p>Our work has many practical applications.  For instance, it may be used for cataloguing music that is uploaded
                    to a library, or as a basis for a song recommendation application. In theory, a major extension of this learning
                    algorithm could even allow for computer construction of basic song forms for a particular genre.
                    
                    On a more theoretical note, this feature extraction and classification process also has the potential to reveal some of the characteristics,
                    such as lyrical tendencies and audio features, that determine the way a song is perceived - in other words, the traits of
                    a song that cause it to be associated with specific genres such as "rock" or "country". This knowledge has applications far
                    beyond genre classification and could be used for many other applications, including song popularity predictors or
                    automated music generators to name but a few examples.</p>

				</div>
			</div>
		</section>
		<!-- END INTRODUCTION SECTION -->
		
		<!-- START APPROACH SECTION -->
		<section id="approach">
			<div class="row">
				<div class="col-xs-12 col-sm-8 col-sm-offset-2 intro">
					<h1>Our Approach</h1></br>


<p>In order to conduct a comparitive analysis of different classification methods, we approached genre classification from two completely different angles. The first approach utilized Music Information Retrieval (MIR) methods to extract audio features and use these features to train a Bayes Net classifier. The second approach instead makes use of lyrical content, and constructs a Naïve Bayesian Classifier to determine a song's genre based on its lyrics.</p></br>

<h4>Audio Features</h4>

<p>In order to extract low-level audio features for use in genre classification, we used <a href="http://marsyas.info/">MARSYAS</a>, an open-source audio processing framework developed by George Tzanetakis. We provided the following features to our classifier:</p></br>
<ol>
  <li><p><a href="http://en.wikipedia.org/wiki/Spectral_centroid">Spectral Centroid</a>. This provides a measure of the “center of gravity” of the frequency spectrum. Higher values correspond to a “brighter” sound.
</p></li>
  <li><p>Spectral Rolloff. This measures the frequency below which 85% of the magnitude distribution is concentrated.</p></li>
  <li><p><a href="http://en.wikipedia.org/wiki/Spectral_flux">Spectral Flux</a>. This measures the amount of spectral variation between adjacent short sections of the audio file.</p></li>
  <li><p>Time domain zero crossings. This measures the noisiness of the signal.</p></li>
  <li><p><a href="http://en.wikipedia.org/wiki/Mel-frequency_cepstrum">Mel-Frequency Cepstral Coefficients (MFCC’s)</a>. MFCC's describe the harmonic content of a song through an analysis of the prevailing frequences based on how far apart certain frequences "sound" to our ears in the context of music. in perceptual terms.  of  perceptually motivated, based on STFT.</p></li>
  <li><p><a href="http://en.wikipedia.org/wiki/Spectral_flatness">Spectral Flatness.</a> This is a measure of the spectral variance throughout an audio file.</p></li>
</ol>
</br>
<p>MARSYAS provides automated command-line tools for collecting all of these features from a collection of audio files and compiling the results into a single data file in a format (.arff) that can be readily imported into Weka. <a href="http://www.cs.waikato.ac.nz/ml/weka/">Weka</a> is a machine learning toolbox with implemented in Java with a graphical interface that allows easy implementation of a variety of machine learning methods. Since MARSYAS was built in order to be able to integrate with Weka, the interface between the two is seamless and we can simply import the .arff file generated by MARSYAS into Weka for analysis.</p>
<p>Using Weka, we tried out a variety of learning methods and analyzed their effectiveness using 10-fold cross-validation with our 800-song dataset (more detail on this <a href="#dataset">below</a>). In addition to the normal range of learning methods, we were also able to implement boosting with the AdaBoost algorithm.</p>

</br><h4>Lyrics</h4>

<p>We collected lyrics data using a python script in conjunction with the <a href="http://www.chartlyrics.com/api.aspx">ChartLyrics API</a>. We created a list of song and artist names contained in the <a href="#dataset">GTZAN dataset</a> based on a list provided by George T., then pulled the lyrics for these tracks from ChartLyrics. We decided not to attempt lyrics-based classification for jazz and classical because songs from these two genres are mostly instrumentals.</p>

<p>Even though we were unable to find the lyrics for some songs in the database, and some songs in the dataset turned out to be instrumentals, we were able to successfully scrape lyrics for <span class="number">68.375%</span> of the songs that we tried.  With a total of <span class="number">547</span> songs about evenly distributed among all <span class="number">8</span> genres, we had lyrics for about <span class="number">68</span> songs per genre.</p>

<p>We used three different methods to attempt to classify lyrics, which we call the Existence Method, the Probability Method, and the Word Count Method.  The <span class="number">Existence Method</span> consisted of a Naive Bayes Classifier that used a dictionary made up of words from the songs.  In this method, we only added to a word's probability if it existed at all in a song and didn't increase its probability based on the number of times it was used in a song.  If our training set consisted of genre <i>G</i> with songs with the lyrics: </p>
	<ul style="list-style-position:inside; list-style-type:none">
		<li><p><b>Song 1</b>: <i>I love you, you love me</i></p></li>
		<li><p><b>Song 2</b>: <i>Love is all you need</i></p></li>
	</ul>
<p>then the probability of <i>love</i> being in <i>G</i> is <span class="number">1</span>.  The <span class="number">Probability Method</span> was also a Naive Bayes classifier, but the dictionary was calculated differently.  For this method, the probability was number of times a word appeared in a genre over number of words in that genre.  For the above example, the probability of <i>love</i> being in <i>G</i> is <span class="number">3/11</span>, or <span class="number">0.272</span>.  The <span class="number">Word Count Method</span> simply found the average number of words in each genre and classified a song <i>S</i> based on the closest average to the number of words in <i>S</i>.


				</div>
			</div>
		</section>
		<!-- END APPROACH SECTION -->

    <!-- START DATASET SECTION -->
    <section id="dataset">
      <div class="row">
        <div class="col-xs-12 col-sm-8 col-sm-offset-2 intro">
          <h1>Dataset:</h1>
          <p>In order to conduct our comparative analysis of these two approaches to the genre classification problem, we used the <a href="http://marsyas.info/download/data_sets/">GTZAN Dataset</a>, which was also developed by George Tzanetakis. This dataset consists of 100 short song clips in each of 10 genres. The clips are each about 30 seconds long, and are drawn from a variety of sources, including live performances and radio broadcasts in addition to typical studio recordings.</p>

          <p>The dataset doesn't come with song title and artist information, but we were able to obtain this information for most songs thanks to the research of Bob Sturm. Since the jazz and classical songs included in the dataset are all completely instrumental and therefore don't have lyrics for us to analyze, we decided to work with the other 8 genres only. These genres are blues, country, disco, hip hop, metal, pop, reggae, and rock.</p>

        </div>
      </div>
    </section>
    <!-- END DATASET SECTION -->
		
		<!-- START RESULTS SECTION -->
		<section id="results">
			<div class="row">
				<div class="col-xs-12 col-sm-8 col-sm-offset-2 intro">
					<h1>Results</h1>
					<br/><h4>Lyrics</h4><br/>
					<p>
						Neither of the Naive Bayes methods to use lyrics as the basis for a genre classifier worked well in practice.  In order to test the statistcal significance of our results, we did 10-fold cross-validation.  We used a single-sample <i>t</i>-test to compare the effectiveness of our method to prior probability.  We used this one because we were attempting to determine if the corrrect classification rates of our methods were statistically different the known correct classification rate of prior probability.
					</p>

					<br/><h5 id="existence-method"><i>Existence Method</i></h5>			
					<p>
						This method worked just about as well as prior probability.  The mean correct classification rate was <span class="number">0.1275</span> with a standard deviation of <span class="number">0.0249</span>.  When compared to a prior probability of <span class="number">0.125</span>, there was no statistical difference (<i>p</i> = <span class="number">0.7577</span>).  There was, however, an interesting trend in the data.  This can be seen in the plot of the correct classifiactions and the confusion matrix, both shown below.
					</p>
					<img src="images/graphs/Lyrics_Method1.jpg"/>
					<img src="images/tables/Lyrics_Method1_1.png"/>
					<p>
						As can be seen, almost all of the songs are classified as hip-hop.  This may be because of the sheer volume of words in many hip-hop songs.  Since there are so many words in hip-hop, the chance of a word existing in a hip-hop song is much greater than the chance of a word existing in any other genre.  
					</p>
					<p>
						As an empirical example, in our dataset the average number of words in a hip-hop song is about <span class="number">415</span> and the average number of words in a blues song is about <span class="number">165</span>.  This means that for the word <i>car</i>, there is about a <span class="number">2.5</span> times higher chance it exists in a hip-hop song than in a blues song.  This difference makes it much more likely that our classifier will say a song is hip-hop than a different genre.  The full table of average word count per genre is shown below.
					</p>
					<img src="images/tables/Lyrics_Avg_Word_Count.png"/>
					<p>
						Since hip-hop seemed like an outlier in our dataset, we wanted to investigate what the results would look like if the genre wasn't included in the dataset at all.  We found a mean correct classification rate of <span class="number">0.2829</span> with a standard deviation of <span class="number">0.0579</span>.  This was statistically different from the prior probability of <span class="number">0.143</span> (<i>p</i> = <span class="number">3.1505e-5</span>).  Though these results are promising, we were simply following an intellectual curiosity.  Hip-hop is an important genre, and for our classifier to be unable to have it in the dataset is detrimental to its success.
					</p>

					<br/><h5><i>Probability Method</i></h5>
					<p>
						This method was nowhere near as successful as the previous method, which wasn't any good itself.  We found a mean correct classification rate of <span class="number">0.900</span> and a standard deviation of <span class="number">0.0316</span>.  This was significantly different from the prior probability of <span class="number">0.125</span>, with <i>p</i> = <span class="number">0.0067</span>.  However, this method was significantly <i>worse</i> than prior probability.  Below are a plot of the correct classifcation rates per genre and a confusion matrix.
					</p>
					<img src = "images/graphs/Lyrics_Method2.jpg"/>
					<img src = "images/tables/Lyrics_Method2_1.png"/>
					<p>
						A different interesting trend shows up here.  Now, a lot of songs are being misclassified as blues.  This makes some sense; blues songs contain the least number of words, so when looking up probabilities for a word in a test song, the weight that blues gives is much more than the weight hip-hop gives.  Similar to the previous method, we attempted to remove the outlier genre from the dataset to see if we got better results.  Doing so actually worsened the quality of the classifier!  We found a mean correct classification rate of <span class="number">0.0714</span> with a standard deviation of <span class="number">0.0309</span>.  This method was also significantly worse than prior probability, with <i>p</i> = <span class="number">4.4716e-4</span>.
					</p>

					<br/><h5><i>Word Count Method</i></h5>
					<p>
						After both of these methods failed, we attempted a third method, namely using the total word count in a song to classify it to a genre.  This method is very naive and we didn't expect it to be very successful at all.  However, using we saw a mean correct classification rate of <span class="number">0.2325</span> with a standard deviation of <span class="number">0.0624</span>.  This proved statistically better than prior probability, with <i>p</i> = <span class="number">4.0758e-4</span>.  The plot of correct classification rate and the confusion matrix are shown below.
					</p>
					<img src = "images/graphs/Lyrics_Method3.jpg"/>
					<img src = "images/tables/Lyrics_Method3_1.png"/>
					<p>
						We can see from the plot that the classifier always failed on Country, Disco, and Metal.  There's a very good reason for this.  If we look back to the average number of lyrics per genre, re-ordered from least to most:
					</p>
					<img src = "images/tables/Lyrics_Avg_Word_Count_Sorted.png"/>
					<p>
						it's easy to notice that all three of these genres are sandwiched pretty closely between other genres.  The most evident example of this is metal.  Using this classifier, for a song to be classified as metal it must have between <span class="number">211.72</span> and <span class="number">216.425</span> words.  There's not much room for variation here!  It's because of this strange binning that we don't believe this is a good way to classify songs into genres.  Perhaps if all of the genres had <i>very</i> different word counts this method would be successful, but we believe that this method's success on our dataset shows some consistency in the word count of our dataset, not in the quality of the classifier.  In other words, we believe that our results using only word count shows overfitting, not quality.
					</p>
				</div> 
			</div>
		</section>
		<!-- END RESULTS SECTION -->
		
		<!-- START PAPER SECTION -->
		<section id="paper">
			<div class="row">
				<div class="col-xs-12 col-sm-8 col-sm-offset-2 intro">
                    <h1>Paper</h1>
                    <p> Our extended abstract, available at the link below, provides further information on the project.</p>
                    <p><a href='#'>Extended Abstract</a></p>
                </div>
            </div>
		</section>
		<!-- END PAPER SECTION -->
	
	<!-- Bootstrap Scripts -->
	<script src="js/jquery.js"></script>
	<script src="js/bootstrap.min.js"></script>

	<!-- Jquery Scripts -->
	<script src="js/jquery.mixitup.min.js"></script>
	<script src="js/jquery.easing.js"></script>
	
	<!-- Swiper Plugin -->
	<script  src="js/idangerous.swiper-1.9.3.js"></script>
	
	<!-- Feed Plugins -->
	<script src="js/jquery.timeago.js"></script>
	<script src="js/tweetable.jquery.js"></script>
	<script src="js/jquery.flickr.js"></script>
	<script src="js/jquery.instagram.js"></script>
	
	<!-- Cotton Specific Scripts -->
	<script src="js/scripts.js"></script>
	<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
    <script src="js/respond.min.js"></script>
	
</body>
</html>
